I"<p>Ping是Windows、Unix和Linux系统下的一个命令。ping也属于一个通信协议，是TCP/IP协议的一部分。利用“ping”命令可以检查网络是否连通，可以很好地帮助我们分析和判定网络故障。应用格式：Ping空格IP地址。</p>

<p>Traceroute
是使用跟踪数据包来诊断网络路由与传输延迟的工具，在linux上为Traceroute（与Traceroute6，IPv6版本），在windows上是tracert。</p>

<p>Traceroute
的原理是试图以最小的TTL发出探测包来跟踪数据包到达目标主机所经过的网关，然后监听一个来自网关ICMP的应答。</p>

<p>| traceroute [参数选项] [ hostname | 域名 | IP地址] 参数选项： -i 指定网络接口，对于多个网络接口有用。比如 -i eth1 或-i ppp1等； -m 把在外发探测试包中所用的最大生存期设置为max-ttl次转发，默认值为30次； -n 显示IP地址，不查主机名。当DNS不起作用时常用到这个参数； -p port 探测包使用的基本UDP端口设置为port ，默认值是33434 -q n 在每次设置生存期时，把探测包的个数设置为值n，默认时为3； -r 绕过正常的路由表，直接发送到网络相连的主机； -w n 把对外发探测包的等待响应时间设置为n秒，默认值为3秒； |
|——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————–|</p>

<h2 id="测试一">测试一：</h2>

<p><strong>测试环境：Ubuntu14.04.5</strong></p>

<p>终端输入</p>

<p>| traceroute wikipedia.org |
|————————–|</p>

<p>终端输出</p>

<p>| traceroute to wikipedia.org (198.35.26.96), 30 hops max, 60 byte packets 1 192.168.1.1 (192.168.1.1) 0.503 ms 0.486 ms 0.463 ms 2 211.71.3.1 (211.71.3.1) 4.034 ms 4.386 ms 4.790 ms 3 * * * 4 211.71.0.89 (211.71.0.89) 6.294 ms 6.286 ms 6.273 ms 5 211.71.0.29 (211.71.0.29) 1.564 ms 1.530 ms 1.521 ms 6 10.254.1.44 (10.254.1.44) 1.914 ms 1.335 ms 1.320 ms 7 172.17.20.45 (172.17.20.45) 3.308 ms * * 8 * * * 9 61.51.116.161 (61.51.116.161) 3.054 ms 5.298 ms 5.215 ms 10 124.65.56.61 (124.65.56.61) 5.222 ms 5.267 ms 4.149 ms 11 61.51.112.106 (61.51.112.106) 7.030 ms 6.995 ms 7.007 ms 12 124.65.194.85 (124.65.194.85) 6.746 ms 6.713 ms 6.677 ms 13 219.158.97.186 (219.158.97.186) 7.906 ms 7.916 ms 7.381 ms 14 219.158.98.90 (219.158.98.90) 6.263 ms 6.243 ms 6.405 ms 15 219.158.102.150 (219.158.102.150) 146.674 ms 146.626 ms 145.213 ms 16 219.158.33.18 (219.158.33.18) 145.192 ms 145.762 ms 145.761 ms 17 ae16.cr1.sjc2.us.zip.zayo.com (64.125.31.12) 145.554 ms 145.519 ms 149.110 ms 18 ae11.mpr3.sfo3.us.zip.zayo.com (64.125.24.186) 149.960 ms 149.931 ms 149.946 ms 19 ae0.mpr4.sfo3.us.zip.zayo.com (64.125.25.62) 152.442 ms 152.393 ms 151.553 ms 20 * * * 21 * * * 22 * * * 23 * * * 24 * * * 25 * * * 26 * * * 27 * * * 28 * * * 29 * * * 30 * * * |
|————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————–|</p>

<p>序列号从1开始，每个纪录就是一跳 ，每跳表示一个网关，每行有三个时间，单位是
ms。探测数据包向每个网关发送三个数据包后，网关响应后返回的时间；如果用
traceroute -q 4 linuxsir.org ，表示向每个网关发送4个数据包；
部分行是以星号表示的。出现这样的情况，可能是防火墙封掉了ICMP的返回信息，所以得不到什么相关的数据包返回数据。有时某一网关处延时比较长，有可能是某台网关比较阻塞，也可能是物理设备本身的原因。当然如果某台DNS出现问题时，不能解析主机名、域名时，也会有延时长的现象，可以加-n
参数来避免DNS解析，以IP格式输出数据。</p>

<h2 id="测试二">测试二：</h2>

<p><strong>测试环境：Ubuntu14.04.5</strong></p>

<p>终端输入</p>

<p>| traceroute -q 4 -m 8 <a href="http://www.zhihu.com">www.zhihu.com</a> |
|————————————————————|</p>

<p>终端输出</p>

<p>| traceroute to www.zhihu.com (60.28.215.80), 8 hops max, 60 byte packets 1 192.168.1.1 (192.168.1.1) 0.361 ms 0.560 ms 0.551 ms 0.539 ms 2 211.71.3.1 (211.71.3.1) 3.687 ms 3.931 ms 4.566 ms 4.929 ms 3 * * * * 4 211.71.0.89 (211.71.0.89) 2.136 ms 2.135 ms 2.129 ms 2.364 ms 5 211.71.0.29 (211.71.0.29) 0.943 ms 0.857 ms 0.833 ms 1.050 ms 6 10.254.1.44 (10.254.1.44) 1.529 ms 1.250 ms 1.212 ms 1.382 ms 7 * * * * 8 218.241.251.9 (218.241.251.9) 3.796 ms 3.519 ms 4.060 ms 3.712 ms |
|——————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————-|</p>

<p>该测试限定了８次转发，发送４个包的情形。</p>

<h2 id="测试三">测试三：</h2>

<p>Windows7下tracert测试：</p>

<p>可见tracert的使用方式与traceroute 类似，但支持的参数与traceroute
有所区别，经验证，如下：</p>

<p>| -d 指定不将地址解析为计算机名. -h maximum_hops 指定搜索目标的最大跃点数. -j host-list 与主机列表一起的松散源路由（仅适用于IPv4），指定沿host-list的稀疏源路由列表序进行转发。host-list是以空格隔开的多个路由器IP地址，最多9个。 　　-w timeout 等待每个回复的超时时间(以毫秒为单位). -R 跟踪往返行程路径(仅适用于 IPv6). -S srcaddr 要使用的源地址(仅适用于 IPv6). -4 强制使用 IPv4. -6 强制使用 IPv6. |
|———————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————-|</p>

<h2 id="小结">小结：</h2>

<p>测试了Linux/Windows系统下诊断网络路由与传输延迟的工具，熟悉了traceroute与tracert的使用方式与基本原理</p>
:ET