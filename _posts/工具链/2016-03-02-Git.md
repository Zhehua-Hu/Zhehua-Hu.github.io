---
layout: post
title: Git学习之路
category: 工具链
tags:
    效率工具链
    学习之路
    Git
keywords:
description:
---

## 绪论


---
本文假定使用场景存在远程服务器，如github或自建服务器。

## 初始设置

使用git/github，最初等的需求是使本地端与云端同步。


### 添加用户[只需一次]
目的是在一台计算机上配置好后方便使用git。

* 为方便修改设置，在shell中设置以下变量（请根据自身情况修改）

```
GITHUB_USE_RNAME=Zhehua-Hu
GITHUB_USER_EMAIL=ZhehuaHu@163.com
```

*  输入命令

```
git config --global user.name \"${GITHUB_USE_RNAME}\"
git config --global user.email \"${GITHUB_USER_EMAIL}\"
```

可以使用以下命令检查

```
# 第1条命令是查看本地配置的用户名，
# 第2条命令是查看全局配置的用户名，
# 第3条命令是查看优先级最高的用户名，
# 如果有本地配置项，就读取本地配置项，
# 如果没有本地配置项，就读取全局配置项。
git config --get --local user.name
git config --get --global user.name
git config --get user.name
```

### 设置SSH密钥[只需一次]
目的是为了多次提交不用反复输入用户名与密码。

```
cd ~
mkdir -p .ssh
cd ~/.ssh

ssh-keygen -t rsa -C \"${GITHUB_USER_EMAIL}\"
# 输入保存的文件名，如id_rsa
# 输入保存密码，
# 重复输入
# 文件已生成

# copy pub key to github

# 检查
ssh -T git@github.com
# 若显示 "...You've successfully authenticated..."则完成
cd $cur_pwd
```

[图解参考](http://www.xuanfengge.com/using-ssh-key-link-github-photo-tour.html)


### 创建新项目
先登录github网页， 建立新项目。

为方便期间，设置变量（请根据自身情况修改）

```
PRO_NAME=Enchain
```

### 对于新项目，本地无代码时
应先在github建立新项目，然后clone到本地，有两种方式。

一般Clone他人使用HTTP， Clone自己使用SSH方式。

因为SSH方式在设置密钥后多次提交不用反复输入用户名与密码。

```
# SSH 【Clone自己使用】
git clone git@github.com:${GITHUB_USE_RNAME}/${PRO_NAME}

# HTTP
git clone https://github.com/${GITHUB_USE_RNAME}/${PRO_NAME}	
```

### 对于新项目，本地有代码时

* 在项目文件夹初始化

```
git init
```

该命令使用git生成管理框架，实质上是生成.git文件夹等文件。

* 与云端同步

```
git remote add origin git@github.com:${GITHUB_USE_RNAME}/${PRO_NAME}.git
git push -u origin master
# 此处的-u命令在于同步云端

# 检查是否有两项链接
git remote -v
```


### 同时同步到github与其他云端（如coding）的设置
需求； 一条push命令，同步本地与多个云端服务器

* 提交coding的SSH密钥[只需一次]

```
ssh-keygen -t rsa -C "yourNewEmail@xxx.xxx"
```

* 在项目文件夹内的.git/config修改[对每个有此需求的项目都需配置]
将

```
url = ××××××××××××××××××××××××××××××××××××
fetch = +refs/heads/*:refs/remotes/origin/*
```

添加为

```
url = ××××××××××××××××××××××××××××××××××××
fetch = +refs/heads/*:refs/remotes/origin/*
pushurl= <SSH格式，如git@github.com:${GITHUB_USE_RNAME}/${PRO_NAME}.git>
pushurl= <另一个云端链接>
```


## 最基础工作流
git 最基本的工作流程是

![]({{site.zhehua.images}}/Toolchain/Git/git.png)


```
# 修改本地代码
# 按以下三步同步到云端
git add * 
git commit -m "add your comments"
git push origin master 
```

更加自动化的方法，可以使用Aries


```

git add *
git add --all
git add <list of files>
git add <list of directory>
git add "<list>"

git commit -m "your comments"



git remote rename <origin> <new>
git remote rm hostname


```

---






### Branch
```
查看分支：git branch

创建分支：git branch <name>

切换分支：git checkout <name>

recover certain file :git checkout -- filename

创建+切换分支：git checkout -b <name>

合并某分支到当前分支：git merge <name>
(recommend)git merge --no-ff -m "merge with no-ff" <name>

删除分支：git branch -d <name>
```
### Stash work
```
git stash
git stash list
git stash pop

```


### Tag
```
git tag
git tag <name>
git show <name>

show <sha1> :git log --pretty=oneline --abbrev-c网络ommit
git tag -a <name> -m "comments" <sha1>



命令git push origin <tagname>可以推送一个本地标签；

命令git push origin --tags可以推送全部未推送过的本地标签；

命令git tag -d <tagname>可以删除一个本地标签；

命令git push origin :refs/tags/<tagname>可以删除一个远程标签。

```


### Others
```
git reset --hard HEAD~n
git reset --hard sha1(at least 4 numbers)

git rm
```
## Alias
```
git lg:
git config --global alias.lg "log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit"
```

## Tools
```
git status
git diff
git log
git log --pretty=oneline
git log --pretty=oneline --graph --abbrev-commit
git log --pretty=oneline --abbrev-commit
```



---
# gitignore 语法
[Demo gitignore](https://github.com/github/gitignore)


exclusive usage:
* for folder
> start with "/"

* 1 char
"?"

* n(>=1) chars
"*"

* match list
[<regex>]

inclusive usage:
start with "!"

**Git cannot add a completely empty directory, you can add .gitkeep file in the empty file you want to push**



## Reference

* 网络资源
[廖雪峰中文教程](http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000)

[Git远程操作详解](http://www.ruanyifeng.com/blog/2014/06/git_remote.html)

[GotGitHub](http://www.worldhello.net/gotgithub/)

[English Tutorial](https://try.github.io)


* 进阶资源